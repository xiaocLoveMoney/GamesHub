# ğŸš€ æ„å»ºä¼˜åŒ–é…ç½®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®å·²é…ç½®ä»¥ä¸‹æ„å»ºä¼˜åŒ–ç­–ç•¥ï¼Œä»¥å®ç°æ›´å°çš„åŒ…ä½“ç§¯å’Œæ›´å¿«çš„åŠ è½½é€Ÿåº¦ï¼š

## âœ¨ æ ¸å¿ƒä¼˜åŒ–é¡¹

### 1. ä»£ç åˆ†å‰² (Code Splitting)
- **å¯ç”¨çŠ¶æ€**: âœ“ å·²å¯ç”¨
- **æ–‡ä»¶**: `scripts/build.mjs`
- **é…ç½®**:
  ```javascript
  splitting: true,        // å¯ç”¨ä»£ç åˆ†å‰²
  format: 'esm',         // ä½¿ç”¨ ESM æ ¼å¼ä»¥æ”¯æŒä»£ç åˆ†å‰²
  chunkNames: '[name]-[hash]'  // å¸¦ hash çš„åˆ†å—æ–‡ä»¶å
  ```
- **æ•ˆæœ**: 
  - å°†å¤§å‹åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªå°å—
  - æµè§ˆå™¨åªä¸‹è½½å½“å‰è·¯ç”±éœ€è¦çš„ä»£ç 
  - æé«˜é¦–å±åŠ è½½é€Ÿåº¦

### 2. ä»£ç å‹ç¼© (Minification)
- **å¯ç”¨çŠ¶æ€**: âœ“ ç”Ÿäº§ç¯å¢ƒå¯ç”¨
- **å‹ç¼©é€‰é¡¹**:
  ```javascript
  minify: true,              // å¯ç”¨å‹ç¼©
  minifyWhitespace: true,    // å‹ç¼©ç©ºç™½ç¬¦
  minifyIdentifiers: true,   // å‹ç¼©å˜é‡å
  minifySyntax: true,        // å‹ç¼©è¯­æ³•
  ```
- **è§¦å‘æ¡ä»¶**: è¿è¡Œ `npm run build` (ç”Ÿäº§ç¯å¢ƒ)
- **æ•ˆæœ**: å‡å°‘ 60-70% çš„ JavaScript ä½“ç§¯

### 3. Tree-Shaking ä¼˜åŒ–
- **å¯ç”¨çŠ¶æ€**: âœ“ å·²å¯ç”¨
- **é…ç½®**: 
  ```javascript
  treeShaking: true    // ç§»é™¤æœªä½¿ç”¨çš„ä»£ç 
  ```
- **æ•ˆæœ**: 
  - è‡ªåŠ¨ç§»é™¤ import ä½†æœªä½¿ç”¨çš„ä»£ç 
  - ä¸ ESM æ ¼å¼é…åˆä½¿ç”¨æ•ˆæœæœ€ä½³
  - å‡å°‘åŒ…ä½“ç§¯ 10-30%

### 4. CSS ä¼˜åŒ–
- **Tailwind Tree-Shake**:
  - åªæ‰“åŒ…ä½¿ç”¨åˆ°çš„ CSS ç±»
  - ç”Ÿäº§ç¯å¢ƒ CSS é€šå¸¸ < 50KB

- **PostCSS ä¼˜åŒ–**:
  - Autoprefixer: è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€
  - æ”¯æŒç°ä»£ CSS ç‰¹æ€§

### 5. æµè§ˆå™¨ç›®æ ‡é…ç½®
- **æ–‡ä»¶**: `.browserslistrc`
- **é…ç½®**:
  - æ’é™¤ IE 11, IE 10, IE 9
  - æ”¯æŒæœ€æ–° 2 ä¸ªæµè§ˆå™¨ç‰ˆæœ¬
  - æ”¯æŒ ES6 æ¨¡å—
- **æ•ˆæœ**: 
  - å‡å° polyfill ä½“ç§¯
  - ä½¿ç”¨ç°ä»£ JavaScript ç‰¹æ€§

## ğŸ“Š æ„å»ºç»“æœé¢„æœŸ

### ç”Ÿäº§æ„å»ºå‘½ä»¤
```bash
npm run build
```

### è¾“å‡ºç»“æœ
```
dist/
â”œâ”€â”€ main-abc123.js       # ä¸»åº”ç”¨ (ä»£ç åˆ†å‰²)
â”œâ”€â”€ vendor-def456.js     # ç¬¬ä¸‰æ–¹åº“ (ä»£ç åˆ†å‰²)
â”œâ”€â”€ pages-ghi789.js      # é¡µé¢ç»„ä»¶ (ä»£ç åˆ†å‰²)
â”œâ”€â”€ main-abc123.css      # ä¼˜åŒ–åçš„ CSS
â””â”€â”€ index.html           # HTML å…¥å£
```

### å¤§å°å¯¹æ¯”
| åœºæ™¯ | å¤§å° | è¯´æ˜ |
|------|------|------|
| æœªä¼˜åŒ– | ~2MB | å•æ–‡ä»¶åŒ… |
| ä»£ç åˆ†å‰²å | ~600KB | å¤šä¸ª .js å— |
| å‹ç¼©å | ~200KB | gzip å‹ç¼©å‰ |
| gzip å‹ç¼©å | ~60KB | ç”Ÿäº§ç¯å¢ƒå¤§å° |

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### å¼€å‘ç¯å¢ƒ (ä¸å‹ç¼©ï¼Œæ”¯æŒ Hot Reload)
```bash
npm run dev
# è¾“å‡º: dist ç›®å½•ä¸‹çš„æ–‡ä»¶å¯ç«‹å³è°ƒè¯•
# æ”¯æŒæµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°
```

### ç”Ÿäº§æ„å»º (å‹ç¼© + ä»£ç åˆ†å‰²)
```bash
npm run build
# è¾“å‡º: dist ç›®å½•ä¸‹çš„ä¼˜åŒ–æ–‡ä»¶
# å¯ç”¨æ‰€æœ‰å‹ç¼©å’Œåˆ†å‰²ä¼˜åŒ–
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡æ”¹è¿›

å®æ–½è¿™äº›ä¼˜åŒ–åçš„é¢„æœŸæ”¹è¿›ï¼š

| æŒ‡æ ‡ | æ”¹è¿› |
|------|------|
| é¦–å±åŠ è½½æ—¶é—´ | â†“ 40-60% |
| æ€»åŒ…ä½“ç§¯ | â†“ 70% |
| TTI (å¯äº¤äº’æ—¶é—´) | â†“ 30-50% |
| é¦–å­—èŠ‚æ—¶é—´ | â†“ 60-70% (gzip) |

## ğŸ¯ è¿›é˜¶ä¼˜åŒ–å»ºè®®

### 1. åŠ¨æ€å¯¼å…¥ (Lazy Loading)
```typescript
// è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰²
const LazyComponent = lazy(() => import('./pages/games/Snake'));

// Suspense åŒ…è£¹
<Suspense fallback={<Loading />}>
  <LazyComponent />
</Suspense>
```

### 2. Prefetch/Preload
```html
<!-- é¢„åŠ è½½å…³é”®èµ„æº -->
<link rel="preload" href="main-abc123.js" as="script">
<!-- é¢„è¿æ¥åˆ° CDN -->
<link rel="preconnect" href="https://cdn.example.com">
```

### 3. èµ„æºå‹ç¼© (Brotli)
- æ¯” gzip å‹ç¼©ç‡æ›´é«˜
- é…ç½® Nginx/Apache è‡ªåŠ¨ä½¿ç”¨

### 4. CDN éƒ¨ç½²
- å°†é™æ€èµ„æºéƒ¨ç½²åˆ° CDN
- åŠ é€Ÿå…¨çƒç”¨æˆ·è®¿é—®

## ğŸ› è°ƒè¯•å’Œåˆ†æ

### åˆ†æåŒ…å¤§å°
```bash
# ç”ŸæˆåŒ…ä½“ç§¯æŠ¥å‘Š
npm run build -- --metafile

# ä½¿ç”¨åœ¨çº¿å·¥å…·åˆ†æ
# https://esbuild.github.io/analyze/
```

### å¼€å‘å·¥å…·
- Chrome DevTools Lighthouse: æ€§èƒ½åˆ†æ
- WebPageTest: è¯¦ç»†æ€§èƒ½æµ‹è¯•
- Bundlesize: åŒ…ä½“ç§¯ç›‘æ§

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### scripts/build.mjs
- ä¸»æ„å»ºè„šæœ¬
- é…ç½® esbuild é€‰é¡¹
- æ”¯æŒ `--production` æ ‡å¿—

### tailwind.config.js
- Tailwind CSS é…ç½®
- å®šä¹‰è®¾è®¡ç³»ç»Ÿå˜é‡
- é…ç½® JIT æ¨¡å¼

### postcss.config.js
- PostCSS æ’ä»¶é…ç½®
- Autoprefixer æµè§ˆå™¨å‰ç¼€
- CSS å¤„ç†æµç¨‹

### .browserslistrc
- æµè§ˆå™¨å…¼å®¹æ€§é…ç½®
- ç”Ÿäº§ç¯å¢ƒæµè§ˆå™¨èŒƒå›´

### index.html
- ä¸» HTML å…¥å£
- ESM è„šæœ¬åŠ è½½
- åŠ è½½åŠ¨ç”»

## âœ… æ£€æŸ¥æ¸…å•

- [x] ä»£ç åˆ†å‰²é…ç½®å®Œæˆ
- [x] å‹ç¼©é…ç½®å®Œæˆ
- [x] Tree-shaking é…ç½®å®Œæˆ
- [x] æµè§ˆå™¨ç›®æ ‡ä¼˜åŒ–
- [x] CSS ä¼˜åŒ–é…ç½®
- [x] PostCSS é…ç½®
- [x] HTML æ¨¡å—åŒ–è„šæœ¬åŠ è½½

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **æœ¬åœ°å¼€å‘**:
   ```bash
   npm install
   npm run dev
   ```

2. **ç”Ÿäº§æ„å»º**:
   ```bash
   npm run build
   ```

3. **éƒ¨ç½²ä¼˜åŒ–èµ„æº**:
   - å¯ç”¨ gzip/brotli å‹ç¼©
   - é…ç½® HTTP ç¼“å­˜ç­–ç•¥
   - ä½¿ç”¨ CDN åˆ†å‘

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–ä¼˜åŒ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ– Pull Requestã€‚
